export const KNOWLEDGE_BASE = [
    {
        keywords: ['brand', 'philosophy', 'vision', 'about', 'values', 'danholt', 'tribute', 'story', 'history', 'who'],
        answer: "Danholt Suites operates on the philosophy 'Here is a tribute to good living!'. Our vision is 'Evolved Hospitality'—where we don't just host, we anticipate. Every interaction is a curated moment, and every space is a sanctuary designed to disconnect you from the noise and reconnect you with perfection and excellence."
    },
    {
        keywords: ['room', 'suite', 'accommodation', 'stay', 'sleep', 'standard', 'deluxe', 'executive', 'price', 'cost', 'rate', 'bed', 'night', 'sleep', 'booking'],
        answer: "We offer three luxury room types:\n1. STANDARD ROOM (₦10,000/night): 2 Guests, 25m², queen bed, cozy retreat.\n2. DELUXE ROOM (₦15,000/night): 2 Guests, 35m², king bed, spacious elegance.\n3. EXECUTIVE DELUXE (₦20,000/night): 3 Guests, 45m², super king bed, the pinnacle of luxury."
    },
    {
        keywords: ['location', 'address', 'where', 'find', 'landmark', 'map', 'direction', 'area', 'place', 'street', 'abuja'],
        answer: "We are located at #3 Iyabo, Obeyode Street (Beside Collinear Hospital), Dogbano, Jikwoyi, Phase 3, Abuja, Nigeria."
    },
    {
        keywords: ['contact', 'phone', 'call', 'email', 'reach', 'number', 'support', 'help', 'message', 'talk', 'staff', 'concierge'],
        answer: "You can reach us at 0704 608 0351 / 07046080351 or +234 800 000 0000.\nEmails: reservations@danholt.com (Bookings), concierge@danholt.com (Special requests)."
    },
    {
        keywords: ['food', 'dining', 'eat', 'restaurant', 'kitchen', 'menu', 'meal', 'breakfast', 'lunch', 'dinner', 'drink', 'rice', 'chicken', 'soup', 'jollof', 'indomie', 'yam', 'egg', 'shawarma', 'beer', 'alcohol', 'wine', 'malt', 'wine', 'beverage', 'hungry', 'thirsty', 'thirsty', 'cook', 'chef', 'available food', 'what is cooking', 'can i eat', 'is food available'],
        answer: "The Danholt Kitchen highlights:\n- Jollof/White/Special Fried Rice: ₦4,000\n- Swallow Meals (Pounded Yam, Semo, Garri, Amala, Afang) with Soup: ₦4,000\n- Spicy Chicken: ₦2,000 - ₦2,500\n- Indomie Spicy / Shawarma: ₦2,500\n- Yam & Egg Sauce: ₦3,000\n- Drinks: Water (₦400), Sodas (₦600), Malt/Schweppes/Fayrouz (₦800), Fearless/Predator/Beers (₦1,000), Legend/Heineken (₦1,300), Wines (Robertson ₦12,000, 4th Street ₦10,000)."
    },
    {
        keywords: ['facility', 'amenities', 'hall', 'conference', 'sport', 'gym', 'tennis', 'football', 'pool', 'swim', 'playground', 'kids', 'ball', 'fitness', 'exercise', 'fun', 'event', 'venue', 'meeting'],
        answer: "Our facilities include:\n1. Conference Hall: WiFi, Projector, Sound System.\n2. Sports Facilities: ₦1,500 for Team Match (5-a-side) or Tennis.\n3. Swimming Pool: ₦2,000 access. Includes Adult & Kids sections and Poolside Bar.\n4. Children's Playground: Free access, secure and supervised."
    },
    {
        keywords: ['membership', 'club', 'privilege', 'loyalty', 'bronze', 'silver', 'gold', 'join', 'tier', 'club', 'rewards', 'perks', 'benefit'],
        answer: "Danholt Privilege Club Tiers:\n- BRONZE (₦1,000/mo): 5% off dining, birthday dessert.\n- SILVER (₦3,000/mo): 10% off weekday rooms, priority late checkout.\n- GOLD (₦5,000+/mo): 15% off rooms, priority upgrades, event invites."
    },
    {
        keywords: ['booking', 'reserve', 'reservation', 'payment', 'guests', 'capacity', 'moniepoint', 'bank', 'transfer', 'pay', 'account', 'money'],
        answer: "Book online at /booking. No credit card required. We use Moniepoint for payments (Danholt Suites Ltd). For account details or payment queries, contact reservations@danholt.com or speak to our concierge."
    },
    {
        keywords: ['early check-in', 'late check-out', 'guarantee', 'addon', 'celebration', 'arrival', 'cake', 'decoration', 'surprise', 'birthday', 'anniversary'],
        answer: "Optional Add-ons:\n- Early Check-in / Late Checkout Guarantee: ₦2,000 each.\n- Celebration Setup (Room Decoration): ₦5,000.\n- Sweet Arrival (Cake/Wine/Flowers): ₦10,000."
    },
    {
        keywords: ['airport', 'pickup', 'shuttle', 'transport', 'car', 'rent', 'rental', 'drive', 'taxi', 'uber', 'travel'],
        answer: "Yes, airport pickup is available. We also have cars available for rent if you would like to have a vehicle to use during your stay. Contact concierge@danholt.com for arrangements."
    },
    {
        keywords: ['wifi', 'internet', 'security', 'electricity', '24/7', 'power', 'light', 'safe', 'connection'],
        answer: "We provide free high-speed WiFi, 24/7 electricity, and constant security throughout the property."
    },
    {
        keywords: ['package', 'offer', 'deal', 'promo', 'romantic', 'couple', 'weekend', 'reset', 'business', 'vacation', 'holiday'],
        answer: "Current Packages:\n1. Romantic Escape: Stay, dinner, welcome drink, late checkout.\n2. Weekend Reset: 2 nights, breakfast, facility access.\n3. Business Traveler Pass: Workspace, priority laundry, airport pickup option."
    },
    {
        keywords: ['referral', 'friend', 'invite', 'code', 'friends of danholt', 'recommend', 'share'],
        answer: "Our 'Friends of Danholt' referral program (Beta) allows you to share your code and earn rewards like restaurant credit or late checkouts when friends book."
    },
    {
        keywords: ['wedding', 'event', 'venue', 'rates', 'wedding stay', 'group', 'party', 'ceremony', 'celebration'],
        answer: "If you're attending a wedding or event at Danholt, we offer tailored rates. Use the 'Unlock Rates' feature on the membership page with your event name."
    },
    {
        keywords: ['available', 'availability', 'booked', 'full', 'free', 'empty', 'vacant', 'open', 'when', 'date', 'avalable', 'availble', 'availablity', 'vancancy', 'vacancy'],
        answer: "I can check real-time availability for you! Just a moment while I scan our booking records..."
    }
];


export function findAnswer(query: string): string | null {
    const lowerQuery = query.toLowerCase();
    const queryWords = lowerQuery.split(/\s+/).filter(word => word.length > 2);

    // 1. First Pass: Score based on explicit keywords
    const results = KNOWLEDGE_BASE.map(item => {
        // Match whole words to avoid partial matches like "car" in "career"
        const keywordScore = item.keywords.reduce((score, kw) => {
            if (lowerQuery.includes(kw)) {
                // Exact word match gets more points
                const regex = new RegExp(`\\b${kw}\\b`, 'i');
                return score + (regex.test(lowerQuery) ? 3 : 1);
            }
            return score;
        }, 0);

        // 2. Second Pass: "Smart" fallback - search the answer text itself for words in the query
        const answerMatchScore = queryWords.filter(word =>
            item.answer.toLowerCase().includes(word)
        ).length;

        return {
            item,
            score: (keywordScore * 2) + answerMatchScore
        };
    });

    const bestMatch = results
        .filter(result => result.score > 1) // Higher threshold to avoid weak matches
        .sort((a, b) => b.score - a.score)[0];

    return bestMatch ? bestMatch.item.answer : null;
}
